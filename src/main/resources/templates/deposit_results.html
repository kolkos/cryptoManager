<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>Deposits</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" />
		<link href="/css/style.css" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
		<script src="/js/jquery-3.2.1.min.js"></script>
	</head>
	<body>
		<input type="hidden" id="sortBy" th:value="${sortBy}" />
		<input type="hidden" id="direction" th:value="${direction}" />
		<p>
			<a href="/deposit/add" class="button">Add a deposit</a>
			<a href="#" id="showHideFilter" class="button">Show filter</a>
		</p>
		<!-- 
			Create filter form
		 -->
		<form action="#" th:action="@{/deposit/results}" method="GET">
			<table class="form" id="filter" style="display: none;">
				<thead>
					<tr>
						<th colspan="2">Filter deposits</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Coin:</td>
						<td>
							<select name="filterByCoin" id="filterByCoin" >
								<option value="">-Select coin-</option>
								<option th:each="coin : ${coinList}" 
										th:value="${coin.id}" 
										th:text="${coin.coinMarketCapCoin.symbol + ' (' + coin.coinMarketCapCoin.name + ')'}"
										th:selected="(${coin.id} == *{selectedCoin})">symbol (name)</option>
							</select>
						</td>
					</tr>
					<tr>
						<td>Wallet:</td>
						<td>
							<select name="filterByWallet" id="filterByWallet" >
								<option value="">-Select wallet-</option>
								<option th:each="wallet : ${walletList}" 
								th:value="${wallet.id}" th:text="${wallet.address + ' (' + wallet.coin.coinMarketCapCoin.symbol + ')'}"
								th:selected="(${wallet.id} == *{selectedWallet})">address (coinName)</option>
							</select>
						</td>
					</tr>
					<tr>
						<td>Portfolio:</td>
						<td>
							<select name="filterByPortfolio" id="filterByPortfolio" >
								<option value="">-Select portfolio-</option>
								<option th:each="portfolio : ${portfolioList}" 
								th:value="${portfolio.id}" th:text="${portfolio.name}"
								th:selected="(${portfolio.id} == *{selectedPortfolio})">name</option>
							</select>
						</td>
					</tr>
					<tr>
						<td colspan="2"><button type="submit">Filter</button></td>
					</tr>
				</tbody>
			</table> 
		</form>
		<br />
		<table class="results">
			<thead>
				<tr>
					<th><span>Date</span> <span class="buttonHolder depositDate"></span></th>
					<th><span>Wallet</span> <span class="buttonHolder wallet.address"></span></th>
					<th><span>Coin</span> <span class="buttonHolder wallet.coin.coinMarketCapCoin.symbol"></span></th>
					<th><span>Portfolio</span> <span class="buttonHolder wallet.portfolio.name"></span></th>
					<th><span>Amount</span> <span class="buttonHolder amount"></span></th>
					<th><span>Purchase value</span> <span class="buttonHolder purchaseValue"></span></th>
					<th>Current value</th>
					<th>Difference</th>
					<th><span>Remarks</span> <span class="buttonHolder remarks"></span></th>
					<th>&nbsp;</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="deposit : ${deposits}">
					<td th:text="${#dates.format(deposit.depositDate, 'dd-MM-yyyy')}">depositDate</td>
					<td th:text="${deposit.wallet.address}">address</td>
					<td th:text="${deposit.wallet.coin.coinMarketCapCoin.symbol}">coinName</td>
					<td th:text="${deposit.wallet.portfolio.name}">portfolioName</td>
					<td th:text="${#numbers.formatDecimal(deposit.amount, 1, 'POINT', 8, 'COMMA')}">amount</td>
					<td th:text="${'€ ' + #numbers.formatDecimal(deposit.purchaseValue, 1, 'POINT', 2, 'COMMA')}">purchaseValue</td>
					<td th:text="${'€ ' + #numbers.formatDecimal(deposit.currentDepositValue, 1, 'POINT', 2, 'COMMA')}">currentDepositValue</td>
					<td class="profitLoss" th:text="${'€ ' + #numbers.formatDecimal(deposit.currentDepositDifference, 1, 'POINT', 2, 'COMMA')}">currentDepositDifference</td>
					<td th:text="${deposit.remarks}">remarks</td>
					<td class="autofit">
						<a th:href="@{/deposit/delete/{id}(id=${deposit.id})}" class="tooltip">
							<span class="tooltiptext">Delete this deposit</span>
							<i class="fa fa-trash" style="font-size:24px;"></i>
						</a>
					</td>
				</tr>
			</tbody>
		</table>
		<script src="/js/LoadMenu.js"></script>
		<script src="/js/LoadHeader.js"></script>
		<script src="/js/profitLossFix.js"></script>
		<script src="/js/showHideFilter.js"></script>
		<script src="/js/sortingButtons.js"></script>
	</body>
</html>