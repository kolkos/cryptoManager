<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>Home</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" />
		<link href="/css/style.css" rel="stylesheet" />
		<script src="/js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript" th:inline="javascript">
		    /*<![CDATA[*/
				google.charts.load('current', {'packages':['corechart']});
	      		google.charts.setOnLoadCallback(drawChart);
				var rows = [];
				var header = ['Date', 'value'];
				rows.push(header);

				function drawChart() {
				    var theList = [[${coinValues}]]
					    for (i = 0; i < theList.length; i++) {
					        
					        var date = new Date(theList[i]['requestDate']);
					        console.log(date);
			
					        var value = theList[i]['value'];
			
					        var row = [date, value];
					        rows.push(row);
					        
					    }
					
					var data = google.visualization.arrayToDataTable(rows);
	
					var options = {
						title: [[${coinName}]] + ' value over time',
						height: 500,
						curveType: 'function',
						legend: {
							position: 'bottom'
						},
						hAxis: {
							format: 'dd-MM-yyyy HH:mm',
						},
						pointSize: 5,
			        };
	
					var chart = new google.visualization.LineChart(document.getElementById('chart'));
	
			        chart.draw(data, options);
				}
		
		    /*]]>*/
		</script>
	</head>
	<body>
		<form action="#" method="get">
			<table class="form" style="width: 100% !important; min-width: 100% !important; max-width: 100% !important;">
				<thead>
					<tr>
						<th colspan="5">Change chart</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Number of hours in the past:</td>
						<td>
							<input type="number" name="lastHours" id="lastHours" th:value="${lastHours}"/>
						</td>
						<td>Interval in minutes:</td>
						<td>
							<input type="number" name="intervalInMinutes" id="intervalInMinutes" th:value="${intervalInMinutes}"/>
						</td>
						<td><button type="submit">Update</button></td>
					</tr>
				</tbody>
			</table>
		</form>
		<div id="chart"></div>
		<script src="/js/LoadMenu.js"></script>
		<script src="/js/LoadHeader.js"></script>
	</body>
</html>